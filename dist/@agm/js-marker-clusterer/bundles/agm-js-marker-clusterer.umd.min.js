!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@agm/core"),require("js-marker-clusterer"),require("rxjs")):"function"==typeof define&&define.amd?define("@agm/js-marker-clusterer",["exports","@angular/core","@agm/core","js-marker-clusterer","rxjs"],t):t(((e=e||self).ngmaps=e.ngmaps||{},e.ngmaps.jsMarkerClusterer={}),e.ng.core,e.ngmaps.core,e.MarkerClusterer,e.rxjs)}(this,function(e,t,r,n,i){"use strict";var o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function s(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s}function a(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}var u=function(e){function n(t,r){var n=e.call(this,t,r)||this;return n._mapsWrapper=t,n._zone=r,n._clustererInstance=new Promise(function(e){n._resolver=e}),n}return function(e,t){function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}(n,e),n.prototype.init=function(e){var t=this;this._mapsWrapper.getNativeMap().then(function(r){var n=new MarkerClusterer(r,[],e);t._resolver(n)})},n.prototype.getClustererInstance=function(){return this._clustererInstance},n.prototype.addMarker=function(e){var t=this.getClustererInstance(),r=this._mapsWrapper.createMarker({position:{lat:e.latitude,lng:e.longitude},label:e.label,draggable:e.draggable,icon:e.iconUrl,opacity:e.opacity,visible:e.visible,zIndex:e.zIndex,title:e.title,clickable:e.clickable},!1);Promise.all([t,r]).then(function(e){var t=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return s}(e,2),r=t[0],n=t[1];return r.addMarker(n)}),this._markers.set(e,r)},n.prototype.deleteMarker=function(e){var t=this,r=this._markers.get(e);return null==r?Promise.resolve():r.then(function(r){t._zone.run(function(){r.setMap(null),t.getClustererInstance().then(function(n){n.removeMarker(r),t._markers.delete(e)})})})},n.prototype.clearMarkers=function(){return this.getClustererInstance().then(function(e){e.clearMarkers()})},n.prototype.setGridSize=function(e){this.getClustererInstance().then(function(t){t.setGridSize(e.gridSize)})},n.prototype.setMaxZoom=function(e){this.getClustererInstance().then(function(t){t.setMaxZoom(e.maxZoom)})},n.prototype.setStyles=function(e){this.getClustererInstance().then(function(t){t.setStyles(e.styles)})},n.prototype.setZoomOnClick=function(e){this.getClustererInstance().then(function(t){void 0!==e.zoomOnClick&&(t.zoomOnClick_=e.zoomOnClick)})},n.prototype.setAverageCenter=function(e){this.getClustererInstance().then(function(t){void 0!==e.averageCenter&&(t.averageCenter_=e.averageCenter)})},n.prototype.setImagePath=function(e){this.getClustererInstance().then(function(t){void 0!==e.imagePath&&(t.imagePath_=e.imagePath)})},n.prototype.setMinimumClusterSize=function(e){this.getClustererInstance().then(function(t){void 0!==e.minimumClusterSize&&(t.minimumClusterSize_=e.minimumClusterSize)})},n.prototype.setImageExtension=function(e){this.getClustererInstance().then(function(t){void 0!==e.imageExtension&&(t.imageExtension_=e.imageExtension)})},n.prototype.createClusterEventObservable=function(e){var t=this;return i.Observable.create(function(r){t._zone.runOutsideAngular(function(){t._clustererInstance.then(function(n){n.addListener(e,function(e){return t._zone.run(function(){return r.next(e)})})})})})},n.prototype.setCalculator=function(e){this.getClustererInstance().then(function(t){"function"==typeof e.calculator&&t.setCalculator(e.calculator)})},n=s([t.Injectable(),a("design:paramtypes",[r.GoogleMapsAPIWrapper,t.NgZone])],n)}(r.MarkerManager),c=function(){function e(e){this._clusterManager=e,this.clusterClick=new t.EventEmitter,this.mouseOver=new t.EventEmitter,this.mouseOut=new t.EventEmitter,this._observableSubscriptions=[]}return e.prototype.ngOnDestroy=function(){this._clusterManager.clearMarkers(),this._observableSubscriptions.forEach(function(e){return e.unsubscribe()})},e.prototype.ngOnChanges=function(e){e.gridSize&&this._clusterManager.setGridSize(this),e.maxZoom&&this._clusterManager.setMaxZoom(this),e.zoomOnClick&&this._clusterManager.setZoomOnClick(this),e.averageCenter&&this._clusterManager.setAverageCenter(this),e.minimumClusterSize&&this._clusterManager.setMinimumClusterSize(this),e.imagePath&&this._clusterManager.setImagePath(this),e.imageExtension&&this._clusterManager.setImageExtension(this),e.calculator&&this._clusterManager.setCalculator(this),e.styles&&this._clusterManager.setStyles(this)},e.prototype._addEventListeners=function(){var e=this;[{name:"clusterclick",handler:function(t){return e.clusterClick.emit(t)}},{name:"mouseover",handler:function(t){return e.mouseOver.emit(t)}},{name:"clustermouseover",handler:function(t){return e.mouseOver.emit(t)}},{name:"onMouseoverCluster",handler:function(t){return e.mouseOver.emit(t)}}].forEach(function(t){var r=e._clusterManager.createClusterEventObservable(t.name).subscribe(t.handler);e._observableSubscriptions.push(r)})},e.prototype.ngOnInit=function(){this._addEventListeners(),this._clusterManager.init({gridSize:this.gridSize,maxZoom:this.maxZoom,zoomOnClick:this.zoomOnClick,averageCenter:this.averageCenter,minimumClusterSize:this.minimumClusterSize,styles:this.styles,imagePath:this.imagePath,imageExtension:this.imageExtension,calculator:this.calculator})},s([t.Input(),a("design:type",Number)],e.prototype,"gridSize",void 0),s([t.Input(),a("design:type",Number)],e.prototype,"maxZoom",void 0),s([t.Input(),a("design:type",Boolean)],e.prototype,"zoomOnClick",void 0),s([t.Input(),a("design:type",Boolean)],e.prototype,"averageCenter",void 0),s([t.Input(),a("design:type",Number)],e.prototype,"minimumClusterSize",void 0),s([t.Input(),a("design:type",Array)],e.prototype,"styles",void 0),s([t.Input(),a("design:type",Function)],e.prototype,"calculator",void 0),s([t.Input(),a("design:type",String)],e.prototype,"imagePath",void 0),s([t.Input(),a("design:type",String)],e.prototype,"imageExtension",void 0),s([t.Output(),a("design:type",t.EventEmitter)],e.prototype,"clusterClick",void 0),s([t.Output(),a("design:type",t.EventEmitter)],e.prototype,"mouseOver",void 0),s([t.Output(),a("design:type",t.EventEmitter)],e.prototype,"mouseOut",void 0),e=s([t.Directive({selector:"agm-marker-cluster",providers:[u,{provide:r.MarkerManager,useExisting:u},r.InfoWindowManager]}),a("design:paramtypes",[u])],e)}(),l=function(){function e(){}return e=s([t.NgModule({imports:[r.AgmCoreModule],declarations:[c],exports:[c]})],e)}();e.AgmJsMarkerClustererModule=l,e.AgmMarkerCluster=c,e.ClusterManager=u,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=agm-js-marker-clusterer.umd.min.js.map